name: Update GitOps Repo on PR Merge
on:
  pull_request:
    types:
    - closed
    branches:
    - master
    - stage

jobs:
  stage_merge_job:
    if: github.event.pull_request.merged == true && github.event.pull_request.base.ref == 'stage'
    runs-on: ubuntu-latest
    steps:
    - name: Clone Gitops repository
      uses: actions/checkout@v2
      with:
        repository: 'rattisyam/GitOpsRepo'
        ref: 'master'
    - name: Update values.staging.yaml
      run: |
        ls

  close_job:
    if: github.event.pull_request.merged == false
    runs-on: ubuntu-latest
    steps:
    - run: |
        echo PR #${{ github.event.number }} has been closed without being merged